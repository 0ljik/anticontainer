{
  "type": "sandbox",
  "ns": "downthemall.net",
  "prefix": "studiVZ Album expander (meinVZ, schuelerVZ)",
  "match": "^http://(www\\.)?(?:studi|mein|schueler)vz\\.net/Photos/Album/[^/]+/[^/]+(/p/\\d+)?$",
  "resolve": "var reImages = /<a[^>]+href=\"(\\/Photos\\/View\\/[^\"]+)\"/img;\u000avar rePages = /<a href=\"[^\"]+\\/p\\/(\\d+)\" class=\"pager\" title=\"(\\d+)\"/ig;\u000a\u000avar url = baseURL.match( /((http:\\/\\/(?:www\\.)?(?:studi|mein|schueler)vz\\.net)\\/Photos\\/Album\\/[^\\/]+\\/[^\\/]+)(?:\\/p\\/(\\d+))?/i );\u000avar curPage = parseInt(url[3], 10) || 1;\u000avar maxPage = curPage;\u000avar loaded = 0;\u000avar images = [];\u000a\u000a// get maximum page\u000avar match;\u000awhile ((match = rePages.exec(responseText)) != null) {\u000a  maxPage = Math.max(maxPage, match[2]);\u000a}\u000a\u000afunction parsePage (page) {\u000a  with (new Request()) {\u000a    onload = function() {\u000a      var m;\u000a      while ((m = reImages.exec(responseText)) != null) {\u000a        images[page-1].push(url[2] + m[1]);\u000a      }\u000a      tryContinue();\u000a    };\u000a    onerror = function() {\u000a      markGone();\u000a      finish();\u000a    };\u000a    open('GET', url[1] + '/p/' + page);\u000a    send();\u000a  }\u000a}\u000a\u000afunction tryContinue () {\u000a  if (++loaded < maxPage) {\u000a    return;\u000a  }\u000a  for (var i = 0; i < maxPage; i++) {\u000a    for each (var url in images[i]) {\u000a      addDownload(url);\u000a    }\u000a  }\u000a  setURL(null);\u000a  finish();\u000a}\u000a\u000afor (var i = 1; i <= maxPage; i++) {\u000a  images[i - 1] = [];\u000a  if (i != curPage) {\u000a    parsePage(i);\u000a  }\u000a  else {\u000a    var m;\u000a    while ((m = reImages.exec(responseText)) != null) {\u000a      images[i - 1].push(url[2] + m[1]);\u000a    }\u000a    tryContinue();\u000a  }\u000a}"
}